__NUXT_JSONP__("/blog/2015-08-31-renfe-project-lines", (function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W){return {data:[{article:{slug:"2015-08-31-renfe-project-lines",description:"El primer paso del proyecto RENFE consistió en\nposicionar las estaciones. Una vez realizada esta tarea\npuedo construir un mapa con los recorridos de los trenes utilizando la información de horarios y paradas que\naparece en la web de RENFE. De esta forma puedo construir el trayecto seguido por un tren cualquiera, por un\ntipo de trenes o por todos ellos y, lo que es más importante, puedo saber qué estaciones están conectadas\ncon cuales, lo que me permitirá construir el grafo de la infraestructura.",lang:y,title:"La infraestructura ferroviaria (ADIF)",date:"2015-08-31T00:00:00.000Z",author:h,category:"Projects",tags:["renfe","railway","geo","cartodb"],toc:[{id:z,depth:t,text:A},{id:B,depth:t,text:C},{id:D,depth:E,text:F},{id:G,depth:E,text:H},{id:I,depth:t,text:J}],body:{type:u,children:[{type:b,tag:d,props:{},children:[{type:a,value:K},{type:b,tag:f,props:{to:v},children:[{type:a,value:L}]},{type:a,value:M},{type:b,tag:f,props:{to:n},children:[{type:a,value:N}]},{type:a,value:O},{type:b,tag:o,props:{},children:[{type:a,value:P}]},{type:a,value:Q}]},{type:a,value:c},{type:a,value:c},{type:b,tag:w,props:{src:"\u002Fimg\u002F2015\u002Frenfe-lines-alvia-with-errors.png",alt:"Mapa de conexiones de los trenes ALVIA de RENFE",caption:"Grafo de conexiones de los trenes ALVIA de RENFE, se muestra con colores el número de composiciones\nque hacen uso de cada conexión."},children:[{type:a,value:c}]},{type:a,value:c},{type:b,tag:x,props:{id:z},children:[{type:b,tag:g,props:{href:"#detecci%C3%B3n-de-errores",ariaHidden:i,tabIndex:j},children:[{type:b,tag:k,props:{className:[l,m]},children:[]}]},{type:a,value:A}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"En el gráfico anterior se puede ver un dibujo esquemático de las conexiones que cubren los trenes ALVIA,\nen él se aprecian dos errores claros de posicionamiento de las estaciones. Uno de ellos está en el trayecto\nentre Córdoba y Málaga donde se realizan paradas en Puente Genil (correctamente situado en el mapa)\ny Antequera (que aparece erroneamente en Valencia); el otro está relacionado con una estación gallega\nque aparece en tierras cántabras."}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"Podemos detectar estos errores de dos formas:"}]},{type:a,value:c},{type:b,tag:p,props:{},children:[{type:a,value:c},{type:b,tag:e,props:{},children:[{type:a,value:"Visualmente: en el caso anterior está claro que Antequera es un error de posicionamiento."}]},{type:a,value:c},{type:b,tag:e,props:{},children:[{type:a,value:"Con un algoritmo: puesto que tengo los horarios de los trenes puedo calcular la velocidad a la\ncual deberían viajar para recorrer la distancia entre cada par de estaciones, si esta velocidad\nestá fuera de unos rangos normales sabré que alguna de las estaciones (origen o destino) está\nmal posicionada, ejecutando el algoritmo para todos los pares de estaciones puedo resolver la ambigüedades."}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"Una vez que he detectado las estaciones mal posicionadas puedo utilizar el\n"},{type:b,tag:f,props:{to:"\u002Fblog\u002F2015-08-25-trilateration-with-errors"},children:[{type:a,value:"algoritmo de trilateración"}]},{type:a,value:"\npara calcular su posición correcta o bien solucionar el problema manualmente."}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"Con los datos corregidos ya puedo generar mapas con las conexiones directas entre estaciones\nsegún el tipo de tren como es el caso de la siguiente figura donde aparecen las conexiones\nde trenes MD, TALGO y Tren Hotel."}]},{type:a,value:c},{type:b,tag:w,props:{src:"\u002Fimg\u002F2015\u002Frenfe-lines-md-talgo-trenhotel.png",alt:"Mapa de conexiones de los trenes MD, TALGO y Tren Hotel",caption:"Mapa de conexiones de los trenes MD (naranja), TALGO (rojo) y Tren Hotel (verde) de RENFE; en blanco se\nmuestran las estaciones donde hacen parada."},children:[{type:a,value:c}]},{type:a,value:c},{type:b,tag:x,props:{id:B},children:[{type:b,tag:g,props:{href:"#grafo-de-l%C3%ADneas",ariaHidden:i,tabIndex:j},children:[{type:b,tag:k,props:{className:[l,m]},children:[]}]},{type:a,value:C}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"El objetivo que persigo en esta parte es construir un grafo con toda la infraestructura ferroviaria\nespañola, donde los nodos sean las estaciones y las uniones entre líneas y los arcos sean las vías\nque los conectan. Idealmente cada arco y nodo podrá tener sus atributos indicando si está electrificado,\ncuál es la velocidad máxima, ancho de vía, distancia,..."}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"Para lograr realizar este grafo me tengo que apoyar en los grafos por tipo de tren del apartado anterior\npara saber qué estaciones están conectadas con cuáles, pero la dificultad estriba en relacionar esas\nestaciones con la infraestructura subyacente."}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"Como indiqué en el artículo de introducción, gracias a "},{type:b,tag:g,props:{href:"https:\u002F\u002Fastroide.cartodb.com\u002Fmaps",rel:[R,S,T],target:U},children:[{type:a,value:"Astroide"}]},{type:a,value:" he conseguido la información de las\nlíneas, pero no se incluyen las estaciones ni las uniones entre líneas."}]},{type:a,value:c},{type:b,tag:V,props:{id:D},children:[{type:b,tag:g,props:{href:"#posici%C3%B3n-de-las-estaciones-sobre-las-l%C3%ADneas",ariaHidden:i,tabIndex:j},children:[{type:b,tag:k,props:{className:[l,m]},children:[]}]},{type:a,value:F}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"Una vez que he realizado el trabajo de posicionamiento de las estaciones en el mapa puedo proyectarlas\nsobre la línea más cercana, son unos cálculos triviales utilizando la librería "},{type:b,tag:g,props:{href:"http:\u002F\u002Ftoblerity.org\u002Fshapely\u002Fmanual.html",rel:[R,S,T],target:U},children:[{type:a,value:"shapely"}]},{type:a,value:". Esta proyección\nque ya hicimos en el artículo sobre ("},{type:b,tag:f,props:{to:n},children:[{type:a,value:"estaciones"}]},{type:a,value:") nos\nsirve también para validar el posicionamiento de las mismas."}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"Sería muy interesante contar con las líneas de Portugal (algunas estaciones pertenecen a este país) y\ncon la información de vías desmanteladas para validar la posición de estaciones en desuso."}]},{type:a,value:c},{type:b,tag:V,props:{id:G},children:[{type:b,tag:g,props:{href:"#cruces-entre-l%C3%ADneas",ariaHidden:i,tabIndex:j},children:[{type:b,tag:k,props:{className:[l,m]},children:[]}]},{type:a,value:H}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"El otro algoritmo que he aplicado sobre las líneas es el cálculo de las intersecciones que se producen\nentre ellas buscando puntos comunes. Este algoritmo identifica tres tipos de puntos comunes:"}]},{type:a,value:c},{type:b,tag:p,props:{},children:[{type:a,value:c},{type:b,tag:e,props:{},children:[{type:a,value:"las intersecciones entre líneas: lugares donde una línea pasa sobre otra sin que haya unión entre ambas."}]},{type:a,value:c},{type:b,tag:e,props:{},children:[{type:a,value:"los puntos de unión: lugares donde dos vías se unen para formar una sola (o separan)."}]},{type:a,value:c},{type:b,tag:e,props:{},children:[{type:a,value:"los empalmes: lugares donde empieza una vía a continuación de otra."}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:w,props:{src:"\u002Fimg\u002F2015\u002Frenfe-lines-leon.png",alt:"Intersecciones entre líneas en las proximidades de León.",caption:"Mapa de intersecciones entre líneas (puntos blancos) en las proximidades de la ciudad de León."},children:[{type:a,value:c}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"Sin embargo la casuística es muy grande y hay muchos errores en los que aún tengo que trabajar:"}]},{type:a,value:c},{type:b,tag:p,props:{},children:[{type:a,value:c},{type:b,tag:e,props:{},children:[{type:b,tag:o,props:{},children:[{type:a,value:"Falsos positivos"}]},{type:a,value:": los cruces entre líneas sin unión entre ellas no deben ser incluídos en el grafo resultante."}]},{type:a,value:c},{type:b,tag:e,props:{},children:[{type:b,tag:o,props:{},children:[{type:a,value:"Falsos negativos"}]},{type:a,value:": uniones entre líneas que no comparten ningún punto geométrico común por redondeos u\nerrores en los datos. El algoritmo debe permitir cierto error a la hora de identificar los cruces (sin\nintroducir más falsos positivos)."}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:"base-alert",props:{type:"next"},children:[{type:a,value:"\nEl resultado con el grafo final tendrá que esperar un poco más, aún está en construcción.\n"}]},{type:a,value:c},{type:b,tag:x,props:{id:I},children:[{type:b,tag:g,props:{href:"#m%C3%A1s-sobre-el-proyecto",ariaHidden:i,tabIndex:j},children:[{type:b,tag:k,props:{className:[l,m]},children:[]}]},{type:a,value:J}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"El proyecto se desarrolla en los siguientes artículos:"}]},{type:a,value:c},{type:b,tag:p,props:{},children:[{type:a,value:c},{type:b,tag:e,props:{},children:[{type:a,value:"Mapa dinámico de circulaciones ("},{type:b,tag:f,props:{to:v},children:[{type:a,value:q}]},{type:a,value:r}]},{type:a,value:c},{type:b,tag:e,props:{},children:[{type:a,value:"Geolocalización de estaciones (ADIF) ("},{type:b,tag:f,props:{to:n},children:[{type:a,value:q}]},{type:a,value:r}]},{type:a,value:c},{type:b,tag:e,props:{},children:[{type:a,value:"La infraestructura ferroviaria (ADIF) ("},{type:b,tag:f,props:{to:"\u002Fblog\u002F2015-08-31-renfe-project-lines"},children:[{type:a,value:q}]},{type:a,value:r}]},{type:a,value:c},{type:b,tag:e,props:{},children:[{type:a,value:"Circulaciones de trenes (RENFE) ("},{type:b,tag:f,props:{to:"\u002Fblog\u002F2015-09-01-renfe-project-trains"},children:[{type:a,value:q}]},{type:a,value:r}]},{type:a,value:c}]}]},excerpt:{type:u,children:[{type:b,tag:d,props:{},children:[{type:a,value:K},{type:b,tag:f,props:{to:v},children:[{type:a,value:L}]},{type:a,value:M},{type:b,tag:f,props:{to:n},children:[{type:a,value:N}]},{type:a,value:O},{type:b,tag:o,props:{},children:[{type:a,value:P}]},{type:a,value:Q}]}]},dir:"\u002Farticles",path:"\u002Farticles\u002F2015-08-31-renfe-project-lines",extension:W,createdAt:s,updatedAt:s},prev:{slug:"2015-08-27-renfe-project-stations",title:"Geolocalización de estaciones (ADIF)"},next:{slug:"2015-09-01-renfe-project-trains",title:"Circulaciones de trenes (RENFE)"}}],fetch:{"0":{owner:{slug:h,lang:y,name:"Javier G. Sogo",role:"Software developer",bio:"May the forc++ be with you",image:"\u002Fimg\u002Fjavi.jpeg",social:{github:h,twitter:h,linkedin:h},toc:[],body:{type:u,children:[]},dir:"\u002Fauthors",path:"\u002Fauthors\u002Fjgsogo",extension:W,createdAt:s,updatedAt:s},showModal:false,tweet_text:"Hey @jgsogo! I've read https:\u002F\u002Fjgsogo.es\u002Fblog\u002F2015-08-31-renfe-project-lines and want to..."}},mutations:void 0}}("text","element","\n","p","li","nuxt-link","a","jgsogo","true",-1,"span","icon","icon-link","\u002Fblog\u002F2015-08-27-renfe-project-stations","strong","ul","ver artículo",").","2021-11-17T09:47:44.593Z",2,"root","\u002Fblog\u002F2015-08-25-renfe-project","article-image","h2","es","detección-de-errores","Detección de errores","grafo-de-líneas","Grafo de líneas","posición-de-las-estaciones-sobre-las-líneas",3,"Posición de las estaciones sobre las líneas","cruces-entre-líneas","Cruces entre líneas","más-sobre-el-proyecto","Más sobre el proyecto","El primer paso del ","proyecto RENFE"," consistió en\n","posicionar las estaciones",". Una vez realizada esta tarea\npuedo construir un mapa con los recorridos de los trenes utilizando la información de horarios y paradas que\naparece en la web de RENFE. De esta forma puedo construir el trayecto seguido por un tren cualquiera, por un\ntipo de trenes o por todos ellos y, lo que es más importante, puedo saber qué estaciones están conectadas\ncon cuales, lo que me permitirá construir ","el grafo de la infraestructura",".","nofollow","noopener","noreferrer","_blank","h3",".md")));